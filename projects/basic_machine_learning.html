<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mike Smith</title>
    <link rel="icon" type="image/" href="https://mikesmith.space/image/m_background.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jura">
    <link rel="stylesheet" href="../style/style.css">
    <!-- Prism.js CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <!-- Prism.js plugins -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css"
        rel="stylesheet" />
    <!-- Prism.js copy button -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css"
        rel="stylesheet" />
</head>

<body>
    <nav id="navbar">
        <div class="nav-container">
            <div class="logo"><img src="https://mikesmith.space/image/cartoon.svg" width="68" height="102"></div>
            <div class="hamburger-menu">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>
            <ul class="nav-links">
                <li><a href="https://mikesmith.space/">Home</a></li>
                <li><a href="https://mikesmith.space/projects.html">Projects</a></li>
                <li><a href="https://mikesmith.space/about_me.html">About Me</a></li>
                <li><a href="https://mikesmith.space/contact.html">Contact</a></li>
            </ul>
        </div>
    </nav>

    <hr margin-top: 0;>

    <section id="path" class="trail">
        <div class="trail-path">
            <a href="https://mikesmith.space/projects.html">Projects</a> > 
            <a href="https://mikesmith.space/projects/basic_machine_learning.html">Basic Machine Learning</a>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <h3>Description</h3>
            <p>
                This project explores some basic concept in machine learning.
            </p>
            <!-- <p>
                <a href="https://github.com/CodingAero/TBD_Repo" target="_blank">Link to the Github Repository</a>
            </p> -->
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-python"># Load Data
import pandas as pd

# Path of the file to read
data_file_path = '../input/train.csv'
my_data = pd.read_csv(data_file_path)

# Print summary statistics in next line
my_data.describe()

# List all columns in the dataset
my_data.columns

# dropna drops missing values (think of na as "not available")
my_data = my_data.dropna(axis=0)

# Select a prediction target
y = my_data.column_x

# Select features
my_data_features = ['column_m', 'column_a', 'column_z', 'column_c', 'column_e']
X = my_data[my_data_features]
print(X.describe())
print(X.head()) # Inspect the data at this stage to spot oddities</code></pre>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-python"># Next use the scikit-learn library to create your model.
# There are four stages to building and using a model: Define, Fit, Predict, and Evaluate.
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeRegressor

# Split data into training and validation subsets to avoid "In-Sample" scores
# Random state guarantees a consistent split with each run
train_X, val_X, train_y, val_y = train_test_split(X, y, random_state = 1)

# Define the model
my_model = DecisionTreeRegressor(random_state = 1)

# Fit the model
my_model.fit(train_X, train_y)

# Make predictions
print("Making initial predictions:")
print(val_X.head())
print("The predictions are")
print(my_model.predict(val_X.head()))

# Compare predictions
print("Check actual values")
print(val_y.head())
print("Compare those to the predictions")
print(my_model.predict(val_X.head()))</code></pre>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-python"># Calculate the mean absolute error
from sklearn.metrics import mean_absolute_error

val_model_predictions = my_model.predict(val_X)

# print the top few validation predictions and actual prices from validation data
print(val_model_predictions[:5])
print(val_y.head())

print(mean_absolute_error(val_y, val_model_predictions))</code></pre>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <p>
                The number of splits, or depth, of a decision tree is a key parameter that controls how complex the
                model is allowed to be. The depth would never need to exceed x, where 2<sup>x</sup> equals number of
                training data points. This will almost certainly lead to overfitting because each leaf could represent a
                single training data point and the lowest Mean Absolute Error is likely to be a lower depth value.
            </p>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-python">from sklearn.metrics import mean_absolute_error
from sklearn.tree import DecisionTreeRegressor

def get_mae(max_leaf_nodes, train_X, val_X, train_y, val_y):
    model = DecisionTreeRegressor(max_leaf_nodes=max_leaf_nodes, random_state=0)
    model.fit(train_X, train_y)
    preds_val = model.predict(val_X)
    mae = mean_absolute_error(val_y, preds_val)
    return(mae)</code></pre>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-python"># A loop can help find a minimum Mean Absolute Error
for max_leaf_nodes in [5, 50, 500, 5000]:
    my_mae = get_mae(max_leaf_nodes, train_X, val_X, train_y, val_y)
    print("Max leaf nodes: %d  \t\t Mean Absolute Error:  %d" %(max_leaf_nodes, my_mae))</code></pre>
        </div>
    </section>

    <section><br><br></section>

    <hr>

    <footer>
        <div class="footer-container">
            <div class="footer-links">
                <a href="https://mikesmith.space/">Home</a>
            </div>
            <div class="copyright">
                &copy; 2025 Mike Smith. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Auto Loader -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/file-highlight/prism-file-highlight.min.js"></script>
    <!-- Prism.js JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

    <script>
        const hamburger = document.querySelector(".hamburger-menu");
        const navLinks = document.querySelector(".nav-links");

        hamburger.addEventListener("click", () => {
            navLinks.classList.toggle("active");
        });
    </script>

</body>

</html>
