<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mike Smith</title>
    <link rel="icon" type="image/" href="https://mikesmith.space/image/m_background.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jura">
    <link rel="stylesheet" href="../style/style.css">
    <!-- Prism.js CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <!-- Prism.js plugins -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css"
        rel="stylesheet" />
    <!-- Prism.js copy button -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css"
        rel="stylesheet" />
</head>

<body>
    <nav id="navbar">
        <div class="nav-container">
            <div class="logo"><img src="https://mikesmith.space/image/cartoon.svg" width="68" height="102"></div>
            <div class="hamburger-menu">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>
            <ul class="nav-links">
                <li><a href="https://mikesmith.space/">Home</a></li>
                <li><a href="https://mikesmith.space/projects.html">Projects</a></li>
                <li><a href="https://mikesmith.space/about_me.html">About Me</a></li>
                <li><a href="https://mikesmith.space/contact.html">Contact</a></li>
            </ul>
        </div>
    </nav>

    <hr margin-top: 0;>

    <section id="path" class="trail">
        <div class="trail-path">
            <a href="https://mikesmith.space/projects.html">Projects</a> > 
            <a href="https://mikesmith.space/projects/data_provenance.html">Data Provenance</a>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <h3>Description</h3>
            <p>
                JSON files are a common way to store and share data. I often find myself needing to write out just the values 
                for various purposes. Perhaps this is to quickly spot trends, duplicates, or unexpected values. While I could write 
                individual scripts for each of these tasks, I have found this common approach to printing values has been extremely useful. 
                Printing just the values immediately leaves me with the question of "Where did this value come from?" For that reason, I 
                have also chosen to print the keys leading up to a particular value. This approach provides some version of "data provenance" 
                so I can quickly see not only the values but the context in which that value exists.
            </p>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <h3>Running the Program</h3>
            <p>
                This program is run using the following command structure:
            </p>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-shell">go run .\data_provenance.go</code></pre>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <h3>File Structure</h3>
            <p>
                For this project, files are organized into a single folder in the following way:
            </p>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-shell">data_provenance/
├── data_provenance.go
├── test_1.json
├── test_2.json</code></pre>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <h3>The Code</h3>
            <p>
                The core logic of this program is contained in the data_provenance.go file. The test_1.json and test_2.json files are
                simply example files that can be used to test the program and verify its functionality. The code reads in a test JSON file, 
                parses it, and then recursively traverses the structure to print out each value along with its corresponding keys. 
                This approach provides a clear view of the values and their corresponding key structure.
            </p>
            <p>
                Below is the code for the data_provenance.go file.
            </p>
        </div>
    </section>

    <section id="code" class="section">
        <div class="container">
            <pre class="line-numbers"><code class="language-go">package main

import (
	"encoding/json"
	"fmt"
	"os"
)

func expand(k_input string, v any, values []map[string]string) []map[string]string {
	if item, verify := v.(map[string]any); verify {
		for k, v := range item {
			// fmt.Printf("Key: %s\n", k)
			new_key := fmt.Sprintf("%s/%s", k_input, k)
			values = expand(new_key, v, values)
		}
	} else if item, verify := v.([]any); verify {
		for i, v := range item {
			temp_key := fmt.Sprintf("[%d]", i)
			// fmt.Printf("Key: %v\n", temp_key)
			new_key := fmt.Sprintf("%s/%s", k_input, temp_key)
			values = expand(new_key, v, values)
		}
	} else if item, verify := v.(string); verify {
		// fmt.Printf("Value: %v\n", item)
		values = append(values, map[string]string{k_input: fmt.Sprintf("%v", item)})
	} else if item, verify := v.(float64); verify {
		// fmt.Printf("Value: %v\n", item)
		values = append(values, map[string]string{k_input: fmt.Sprintf("%v", item)})
	} else if item, verify := v.(bool); verify {
		// fmt.Printf("Value: %v\n", item)
		values = append(values, map[string]string{k_input: fmt.Sprintf("%v", item)})
	} else {
		fmt.Printf("\n\n\n==============================\n")
		fmt.Printf("<<< ERROR >>>\n")
		fmt.Printf("Unable to properly parse value:\n%v\n", v)
		fmt.Printf("==============================\n\n\n")
	}

	return values
}

func main() {
	fmt.Printf("Program Started.\n\n")

	values := []map[string]string{}

	filepath := "./test_2.json"
	data, err := os.ReadFile(filepath)
	if err != nil {
		// fmt.Printf("Error 1: %v\n", err)
		os.Exit(1)
	}

	var result map[string]any
	err = json.Unmarshal(data, &result)
	if err != nil {
		// fmt.Printf("Error 2: %v\n", err)
		os.Exit(1)
	}

	for k, v := range result {
		// fmt.Printf("Key: %s\n", k)
		values = expand(string(k), v, values)
	}

	for _, valueMap := range values {
		for k, v := range valueMap {
			fmt.Printf("[%s]: [%s]\n", k, v)
		}
	}

	fmt.Printf("\nProgram Completed.")
}</code></pre>
        </div>
    </section>

    <section><br><br></section>

    <hr>

    <footer>
        <div class="footer-container">
            <div class="footer-links">
                <a href="https://mikesmith.space/">Home</a>
            </div>
            <div class="copyright">
                &copy; 2025 Mike Smith. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Auto Loader -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/file-highlight/prism-file-highlight.min.js"></script>
    <!-- Prism.js JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

    <script>
        const hamburger = document.querySelector(".hamburger-menu");
        const navLinks = document.querySelector(".nav-links");

        hamburger.addEventListener("click", () => {
            navLinks.classList.toggle("active");
        });
    </script>

</body>

</html>
